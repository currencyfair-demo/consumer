FROM debian:jessie
MAINTAINER Robert George <robert@poovelil.org>

RUN echo 'deb http://ftp.es.debian.org/debian stable main contrib non-free' >> /etc/apt/sources.list
RUN echo 'deb-src http://ftp.es.debian.org/debian stable main contrib non-free' >> /etc/apt/sources.list

RUN echo 'deb http://ftp.debian.org/debian/ jessie-updates main contrib non-free' >> /etc/apt/sources.list
RUN echo 'deb-src http://ftp.debian.org/debian/ jessie-updates main contrib non-free' >> /etc/apt/sources.list

RUN DEBIAN_FRONTEND=noninteractive apt-get update && apt-get install -y apache2-mpm-worker\ 
			libapache2-mod-fastcgi \
			curl 

RUN a2enmod actions fastcgi alias rewrite

COPY fastcgi-host.conf /etc/apache2/mods-enabled/fastcgi.conf
COPY api.poovelil.org.conf /etc/apache2/sites-enabled/api.poovelil.org.conf

VOLUME ["/var/www/blog"]
COPY consumer-app /var/www/blog

EXPOSE 80

CMD ["/usr/sbin/apachectl", "-D", "FOREGROUND"]
